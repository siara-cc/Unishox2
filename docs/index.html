<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Unishox: Unishox: A hybrid encoder for Short Unicode Strings</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Unishox
   </div>
   <div id="projectbrief">A hybrid encoder for Short Unicode Strings</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('index.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Unishox: A hybrid encoder for Short Unicode Strings </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__r_e_a_d_m_e"></a></p>
<p><a href="https://github.com/siara-cc/Unishox/actions/workflows/c-cpp.yml"><img src="https://github.com/siara-cc/Unishox/actions/workflows/c-cpp.yml/badge.svg" alt="C/C++ CI" style="pointer-events: none;" class="inline"/></a> <a href="https://doi.org/10.21105/joss.03919"><img src="https://joss.theoj.org/papers/10.21105/joss.03919/status.svg" alt="DOI" style="pointer-events: none;" class="inline"/></a> <a href="https://www.npmjs.com/package/unishox2.siara.cc"><img src="https://img.shields.io/npm/v/unishox2.siara.cc" alt="npm ver" class="inline"/></a> <a href="https://github.com/siara-cc/Unishox2/tree/master/afl_fuzz"><img src="https://img.shields.io/badge/afl%20crashes%2Fhangs-0-green" alt="afl" class="inline"/></a></p>
<p>In general compression utilities such as <span class="tt">zip</span>, <span class="tt">gzip</span> do not compress short strings well and often expand them. They also use lots of memory which makes them unusable in constrained environments like Arduino. So Unishox algorithm was developed for individually compressing (and decompressing) short strings.</p>
<p>This is a C/C++ library. See <a href="https://github.com/tweedge/unishox2-py3">here for CPython version</a> and <a href="https://github.com/siara-cc/Unishox_JS">here for Javascript version</a> which is interoperable with this library.</p>
<p>The contenders for Unishox are <a href="https://github.com/antirez/smaz">Smaz</a>, <a href="https://github.com/Ed-von-Schleck/shoco">Shoco</a>, Unicode.org's <a href="https://www.unicode.org/reports/tr6/tr6-4.html">SCSU</a> and <a href="http://www.unicode.org/notes/tn6/">BOCU</a> (implementations <a href="https://www.unicode.org/Public/PROGRAMS/SCSU/">here</a> and <a href="https://github.com/siara-cc/bocu">here</a>) and <a href="https://ieeexplore.ieee.org/document/9108719">AIMCS</a> (Implementation <a href="https://github.com/MasoudAbedi/AIMCS-an-artificial-intelligence-based-method-for-compression-of-short-strings">here</a>).</p>
<p>Note: Unishox provides the best compression for short text and not to be compared with general purpose compression algorithm like lz4, snappy, lzma, brottli and zstd.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md1"></a>
Applications</h1>
<ul>
<li>Faster transfer of text over low-speed networks such as LORA or BLE</li>
<li>Compression for low memory devices such as Arduino and ESP8266</li>
<li>Compression of Chat application text exchange including Emojis</li>
<li>Storing compressed text in database</li>
<li>Bandwidth and storage cost reduction for Cloud</li>
</ul>
<p><img src="https://github.com/siara-cc/Unishox2/blob/master/promo/Banner1.png?raw=true" alt="Promo picture" class="inline"/></p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md2"></a>
Unishox3 Alpha</h2>
<p>The next version <span class="tt">Unishox3</span> which includes multi-level static dictionaries residing in RAM or Flash memory provides much better compression than <span class="tt">Unishox2</span>. A preview is available in <span class="tt">Unishox3_Alpha</span> folder and a make file is available. To compile please use the following steps:</p>
<div class="fragment"><div class="line">cd Unishox3_Alpha</div>
<div class="line">make</div>
<div class="line">../usx3 &quot;The quick brown fox jumped over the lazy dog&quot;</div>
</div><!-- fragment --><p>This is just a preview and the specification and dictionaries are expected to change before <span class="tt">Unishox3</span> will be released. However, this folder will be retained so if someone used it for compressing strings, they can still use it for decompressing them.</p>
<p>Unishox2 will still be supported for cases where space for storing static dictionaries is an issue.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md3"></a>
How it works</h1>
<p>Unishox is an hybrid encoder (entropy, dictionary and delta coding). It works by assigning fixed prefix-free codes for each letter in the above Character Set (entropy coding). It also encodes repeating letter sets separately (dictionary coding). For Unicode characters, delta coding is used.</p>
<p>The model used for arriving at the prefix-free code is shown below:</p>
<p><img src="https://github.com/siara-cc/Unishox2/blob/master/promo/model.png?raw=true" alt="Promo picture" class="inline"/></p>
<p>The complete specification can be found in this article: <a href="https://github.com/siara-cc/Unishox2/blob/master/Unishox_Article_2.pdf?raw=true">A hybrid encoder for compressing Short Unicode Strings</a>. This can also be found at <span class="tt">figshare</span> <a href="https://figshare.com/articles/preprint/Unishox_A_hybrid_encoder_for_Short_Unicode_Strings/17056334">here</a> with DOI <span class="tt">10.6084/m9.figshare.17056334.v2</span>.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md4"></a>
Compiling</h1>
<p>To compile, just use <span class="tt">make</span> or use gcc as follows:</p>
<div class="fragment"><div class="line">gcc -std=c99 -o unishox2 test_unishox2.c unishox2.c</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md5"></a>
Unit tests (automated)</h1>
<p>For testing the compiled program, use:</p>
<div class="fragment"><div class="line">./test_unishox2 -t</div>
</div><!-- fragment --><p>This invokes <span class="tt">run_unit_tests()</span> function of <span class="tt">test_unishox2.c</span>, which tests all the features of Unishox2, including edge cases, using 159 strings covering several languages, emojis and binary data.</p>
<p>Further, the CI pipeline at <span class="tt">.github/workflows/c-cpp.yml</span> runs these tests for all presets and also tests file compression for the different types of files in <span class="tt">sample_texts</span> folder. This happens whenever a commit is made to the repository.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md6"></a>
API</h1>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="group__core__api.html#ga37df146e9ddd9ff1b07c7c160683d96c">unishox2_compress_simple</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *in, <span class="keywordtype">int</span> len, <span class="keywordtype">char</span> *out);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="group__core__api.html#ga3e5c00a0c5db7979d94b0b294908a04e">unishox2_decompress_simple</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *in, <span class="keywordtype">int</span> len, <span class="keywordtype">char</span> *out);</div>
<div class="ttc" id="agroup__core__api_html_ga37df146e9ddd9ff1b07c7c160683d96c"><div class="ttname"><a href="group__core__api.html#ga37df146e9ddd9ff1b07c7c160683d96c">unishox2_compress_simple</a></div><div class="ttdeci">int unishox2_compress_simple(const char *in, int len, char *out)</div><div class="ttdef"><b>Definition</b> unishox2.c:859</div></div>
<div class="ttc" id="agroup__core__api_html_ga3e5c00a0c5db7979d94b0b294908a04e"><div class="ttname"><a href="group__core__api.html#ga3e5c00a0c5db7979d94b0b294908a04e">unishox2_decompress_simple</a></div><div class="ttdeci">int unishox2_decompress_simple(const char *in, int len, char *out)</div><div class="ttdef"><b>Definition</b> unishox2.c:1383</div></div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md7"></a>
Usage</h1>
<p>To see Unishox in action, simply try to compress a string:</p>
<div class="fragment"><div class="line">./test_unishox2 &quot;Hello World&quot;</div>
</div><!-- fragment --><p>To compress and decompress a file, use:</p>
<div class="fragment"><div class="line">./test_unishox2 -c &lt;input_file&gt; &lt;compressed_file&gt;</div>
<div class="line">./test_unishox2 -d &lt;compressed_file&gt; &lt;decompressed_file&gt;</div>
</div><!-- fragment --><p>Note: Unishox is good for text content upto few kilobytes. Unishox does not give good ratios compressing large files or compressing binary files.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md8"></a>
Character Set</h1>
<p>Unishox supports the entire Unicode character set. As of now it supports UTF-8 as input and output encoding.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md9"></a>
Achieving better overall compression</h1>
<p>Since Unishox is designed and developed for short texts and other methods are not good for short texts, following logic could be used to achieve better overall compression, since the magic bit(s) at the beginning of compressed bytes can be used to identify Unishox or other methods:</p>
<div class="fragment"><div class="line">if (size &lt; 1024)</div>
<div class="line">    output = compress_with_unishox(input);</div>
<div class="line">else</div>
<div class="line">    output = compress_with_any_other(input)</div>
</div><!-- fragment --><p>The threshold size 1024 is arbitrary and if speed is not a concern, it is also possible to compress with both and use the best.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md10"></a>
Interoperability with the JS Library</h1>
<p>Strings that were compressed with this library can be decompressed with the <a href="https://github.com/siara-cc/Unishox_JS">JS Library</a> and vice-versa. However please see <a href="https://github.com/siara-cc/Unishox_JS#interoperability-with-the-c-library">this section in the documentation</a> for usage.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md11"></a>
Projects that use Unishox</h1>
<ul>
<li><a href="https://github.com/siara-cc/Unishox_Arduino_Progmem_lib">Unishox Compression Library for Arduino Progmem</a></li>
<li><a href="https://github.com/siara-cc/Unishox_Sqlite_UDF">Sqlite3 User Defined Function as loadable extension</a></li>
<li><a href="https://github.com/siara-cc/esp32_arduino_sqlite3_lib">Sqlite3 Library for ESP32</a></li>
<li><a href="https://github.com/siara-cc/esp_arduino_sqlite3_lib">Sqlite3 Library for ESP8266</a></li>
<li><a href="https://github.com/arendst/Tasmota/tree/development/tools/unishox">Port of Unishox 1 to Python and C++ by Stephan Hadinger for Tasmota</a></li>
<li><a href="https://github.com/tweedge/unishox2-py3">Python bindings for Unishox2</a></li>
<li><a href="https://github.com/siara-cc/unishox_js">Unishox2 Javascript library</a></li>
<li><a href="https://github.com/meshtastic/Meshtastic-device/tree/master/src/mesh/compression">Unishox2 used in Meshtastic project</a></li>
<li><a href="https://github.com/SheepChef/Abracadabra">Abracadabra, an Advanced Chinese Text Stylized-Encryption Tool</a></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md12"></a>
Credits</h1>
<ul>
<li>Thanks to <a href="https://github.com/leafgarden">Jonathan Greenblatt</a> for his <a href="https://github.com/siara-cc/Unishox/tree/master/Arduino">port of Unishox2 that works on Particle Photon</a></li>
<li>Thanks to <a href="https://github.com/tweedge">Chris Partridge</a> for his <a href="https://github.com/tweedge/unishox2-py3">port of Unishox2 to CPython</a> and his <a href="https://github.com/tweedge/unishox2-py3#integration-tests">comprehensive tests</a> using <a href="https://hypothesis.readthedocs.io/en/latest">Hypothesis</a> and <a href="https://github.com/tweedge/unishox2-py3#performance">extensive performance tests</a></li>
<li>Thanks to <a href="https://github.com/s-hadinger">Stephan Hadinger</a> for his <a href="https://github.com/arendst/Tasmota/tree/development/tools/unishox">port of Unishox1 to Python for Tasmota</a></li>
<li>Thanks to <a href="https://github.com/piponazo">Luis Díaz Más</a> for his PRs to support MSVC and CMake setup</li>
<li>Thanks to <a href="https://github.com/gsm55">James Z.M. Gao</a> for his PRs on improving presets, unit tests, bug fixes and more</li>
<li>Thanks to <a href="https://github.com/mc-hamster">Jm Casler</a> and <a href="https://github.com/kokroo">Shiv Kokroo</a> for choosing and integrating Unishox into <a href="https://github.com/meshtastic/Meshtastic-device">Meshtastic</a> project</li>
<li>Thanks to <a href="https://github.com/SheepChef">SheepChef</a> for integrating Unishox2 with his project <a href="https://github.com/SheepChef/Abracadabra">Abracadabra</a></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md13"></a>
Versions</h1>
<p>The present byte-code version is 2 and it replaces <a href="https://github.com/siara-cc/Unishox2/blob/master/Unishox1/Unishox_Article_1.pdf?raw=true">Unishox 1</a>. Unishox 1 is still available as unishox1.c, but it will have to be compiled manually if it is needed.</p>
<p>The next version would be Unishox3 and it would include a multi-level static dictionaries residing in RAM or Flash memory that would greatly improve compression ratios compared to Unishox2. However Unishox2 will still be supported for cases where space for storing static dictionaries is an issue.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md14"></a>
License for AI bots</h1>
<p>The license mentioned is only applicable for humans and this work is NOT available for AI bots.</p>
<p>AI has been proven to be beneficial to humans especially with the introduction of ChatGPT. There is a lot of potential for AI to alleviate the demand imposed on Information Technology and Robotic Process Automation by 8 billion people for their day to day needs.</p>
<p>However there are a lot of ethical issues particularly affecting those humans who have been trying to help alleviate the demand from 8b people so far. From my perspective, these issues have been <a href="https://medium.com/@arun_77428/does-chatgpt-have-licenses-to-give-out-information-that-it-does-even-then-would-it-be-ethical-7a048e8c3fa2">partially explained in this article</a>.</p>
<p>I am part of this community that has a lot of kind hearted people who have been dedicating their work to open source without anything much to expect in return. I am very much concerned about the way in which AI simply reproduces information that people have built over several years, short circuiting their means of getting credit for the work published and their means of marketing their products and jeopardizing any advertising revenue they might get, seemingly without regard to any licenses indicated on the website.</p>
<p>I think the existing licenses have not taken into account indexing by AI bots and till the time modifications to the licenses are made, this work is unavailable for AI bots.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md15"></a>
Issues</h1>
<p>In case of any issues, please email the Author (Arundale Ramanathan) at <a href="#" onclick="location.href='mai'+'lto:'+'aru'+'n@'+'sia'+'ra'+'.cc'; return false;">arun@<span class="obfuscator">.nosp@m.</span>siar<span class="obfuscator">.nosp@m.</span>a.cc</a> or create GitHub issue. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
